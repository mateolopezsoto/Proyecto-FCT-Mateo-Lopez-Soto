import{a as G}from"./chunk-J3PVLA2Q.js";import{c as B,e as V,j as W,k as Y,l as U,o as $}from"./chunk-3FRVCO6D.js";import{Aa as K,C as y,Ca as j,E as f,G as l,H as k,J as t,K as n,L as v,M as E,N as u,O as _,Q as o,R as x,S as b,U as I,V as F,W as D,Y as T,c as J,d as O,fa as R,ka as H,la as z,o as g,p as P,pa as L,t as w,u as S,wa as N,xa as A,z as r}from"./chunk-6KVODD7N.js";var h=J(K());function Q(s,a){s&1&&(t(0,"div",18)(1,"h3"),o(2,"Administraci\xF3n"),n(),t(3,"button",19),o(4," \u2699\uFE0F Instalaci\xF3ns "),n(),t(5,"button",20),o(6," \u{1F4C5} Xestionar Reservas "),n(),t(7,"button",21),o(8," \u{1F4CA} Estat\xEDsticas "),n()())}function Z(s,a){if(s&1&&(t(0,"option",22),o(1),n()),s&2){let e=a.$implicit;l("value",e.id_tipo),r(),x(e.nome_tipo)}}function ee(s,a){s&1&&(t(0,"div",23),v(1,"i",24),o(2," Cargando instalaci\xF3ns... "),n())}function te(s,a){s&1&&(t(0,"div",25),o(1," Non se atoparon instalaci\xF3ns dispo\xF1ibles. "),n())}function ne(s,a){if(s&1){let e=E();t(0,"div",26)(1,"div",27)(2,"h3"),o(3),n(),t(4,"span",28),o(5),n()(),t(6,"div",29)(7,"p")(8,"strong"),o(9,"Capacidade:"),n(),o(10),n(),t(11,"p")(12,"strong"),o(13,"Estado:"),n(),t(14,"span",30),o(15),n()()(),t(16,"button",31),u("click",function(){let c=w(e).$implicit,d=_();return S(d.reservar(c))}),o(17),n()()}if(s&2){let e=a.$implicit,i=_();r(3),x(e.nome),r(2),x(e.tipo==null?null:e.tipo.nome_tipo),r(5),b(" ",e.capacidade," persoas"),r(4),k("color",e.disponible?"#28a745":"#dc3545"),r(),b(" ",e.disponible?"\u{1F7E2} Disponible":"\u{1F534} "+e.estado_general," "),r(),l("disabled",!e.disponible||i.reservaService.loading()),r(),b(" ",e.disponible?"Reservar Agora":"Non Dispo\xF1ible"," ")}}var X=class s{authService=g(j);reservaService=g(G);router=g(N);filtroTipo=y("");reservableHours=this.generateReservableHours();instalacionsFiltradas=R(()=>{let a=this.reservaService.instalacions(),e=this.filtroTipo();return a.filter(i=>!e||i.tipo.id_tipo===+e)});ngOnInit(){this.authService.estaLogueado()&&this.reservaService.cargarDatos()}esAdmin(){return this.authService.usuario()?.rol?.nome_rol==="Administrador"}constructor(){}generateReservableHours(){let a=[];for(let e=8;e<=21;e++)a.push(`${e.toString().padStart(2,"0")}:00`);return a}filtrar(){}reservar(a){return O(this,null,function*(){let e=this.reservableHours,i=new Date().toISOString().split("T")[0],c=e.map(m=>'<option value="'+m.slice(0,5)+'">'+m.slice(0,5)+"</option>").join(""),d=['<div style="text-align: left;">',"<!-- Campo de Fecha -->",'<label for="swal-date">Data:</label>','<input id="swal-date" type="date" class="swal2-input" value="'+i+'">',"<!-- Campo de Hora de INICIO (HH:MM) -->",'<label for="swal-hour">Hora de Inicio (08:00 - 21:00):</label>','<select id="swal-hour" class="swal2-input">','<option value="">Selecciona a hora de inicio</option>',c,"</select>","</div>"].join(""),p=yield h.default.fire({title:"Reservar: "+a.nome,html:d,focusConfirm:!1,showCancelButton:!0,confirmButtonText:"Confirmar Reserva",cancelButtonText:"Cancelar",preConfirm:()=>{let m=document.getElementById("swal-date"),q=document.getElementById("swal-hour"),C=m.value,M=q.value;return!C||!M?(h.default.showValidationMessage("Debes seleccionar unha data e unha hora de inicio."),!1):{id_instalacion:a.id_instalacion,data_reserva:C,hora_inicio:M}}});if(p.isConfirmed&&p.value)try{yield this.reservaService.reservar({id_instalacion:p.value.id_instalacion,hora_inicio:p.value.hora_inicio,data_reserva:p.value.data_reserva})}catch{}})}static \u0275fac=function(e){return new(e||s)};static \u0275cmp=P({type:s,selectors:[["app-reservas"]],standalone:!0,features:[T],decls:26,vars:6,consts:[[1,"container-reservas"],["src","/assets/logo_principal.png","alt","Logo Centro Deportivo",1,"logo"],[1,"top-buttons"],["routerLink","/mis-reservas"],["routerLink","/perfil"],[1,"logout",3,"click"],[1,"main-container"],[1,"sidebar"],["class","admin-panel",4,"ngIf"],[1,"filters"],["for","tipo"],["id","tipo","name","tipo",3,"ngModelChange","ngModel"],["value",""],[3,"value",4,"ngFor","ngForOf"],[1,"cards-container"],["class","loading",4,"ngIf"],["class","empty-state",4,"ngIf"],["class","card",4,"ngFor","ngForOf"],[1,"admin-panel"],["routerLink","/admin/instalacions",1,"btn-admin"],["routerLink","/admin/reservas",1,"btn-admin"],["routerLink","/admin/estatisticas",1,"btn-admin"],[3,"value"],[1,"loading"],[1,"fas","fa-spinner","fa-spin"],[1,"empty-state"],[1,"card"],[1,"card-header"],[1,"badge-tipo"],[1,"card-body"],[1,"estado-badge"],[1,"btn-reservar",3,"click","disabled"]],template:function(e,i){e&1&&(t(0,"div",0)(1,"header"),v(2,"img",1),t(3,"div",2)(4,"button",3),o(5,"As mi\xF1as reservas"),n(),t(6,"button",4),o(7,"Perfil"),n(),t(8,"button",5),u("click",function(){return i.authService.logout()}),o(9,"Pechar sesi\xF3n"),n()()(),t(10,"div",6)(11,"aside",7),f(12,Q,9,0,"div",8),t(13,"div",9)(14,"h3"),o(15,"Filtros"),n(),t(16,"label",10),o(17,"Tipo de instalaci\xF3n"),n(),t(18,"select",11),D("ngModelChange",function(d){return F(i.filtroTipo,d)||(i.filtroTipo=d),d}),u("ngModelChange",function(){return i.filtrar()}),t(19,"option",12),o(20,"Todos"),n(),f(21,Z,2,2,"option",13),n()()(),t(22,"section",14),f(23,ee,3,0,"div",15)(24,te,2,0,"div",16)(25,ne,18,8,"div",17),n()()()),e&2&&(r(12),l("ngIf",i.esAdmin()),r(6),I("ngModel",i.filtroTipo),r(3),l("ngForOf",i.reservaService.tipos()),r(2),l("ngIf",i.reservaService.loading()),r(),l("ngIf",!i.reservaService.loading()&&i.instalacionsFiltradas().length===0),r(),l("ngForOf",i.instalacionsFiltradas()))},dependencies:[L,H,z,$,Y,U,W,B,V,A],styles:['@charset "UTF-8";*[_ngcontent-%COMP%]{box-sizing:border-box;margin:0;padding:0;font-family:Segoe UI,Tahoma,Geneva,Verdana,sans-serif}.container-reservas[_ngcontent-%COMP%]{display:flex;flex-direction:column;min-height:100vh;background-color:#f0f2f5}header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;background-color:#fff;padding:15px 40px;box-shadow:0 4px 12px #0000000d;z-index:10;position:sticky;top:0}header[_ngcontent-%COMP%]   img.logo[_ngcontent-%COMP%]{height:50px}.top-buttons[_ngcontent-%COMP%]{display:flex;gap:15px}.top-buttons[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{padding:12px 24px;background-color:#4285f4;color:#fff;border:none;border-radius:8px;cursor:pointer;font-weight:600;font-size:1rem;transition:all .2s ease;box-shadow:0 2px 4px #4285f433}.top-buttons[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:hover{background-color:#3367d6;transform:translateY(-2px);box-shadow:0 4px 8px #4285f44d}.logout[_ngcontent-%COMP%]{background-color:#dc3545!important}.logout[_ngcontent-%COMP%]:hover{background-color:#c82333!important;box-shadow:0 4px 8px #dc35454d}.main-container[_ngcontent-%COMP%]{display:flex;flex:1;padding:40px;gap:40px;width:100%}.sidebar[_ngcontent-%COMP%]{width:300px;flex-shrink:0;display:flex;flex-direction:column;gap:25px}.admin-panel[_ngcontent-%COMP%], .filters[_ngcontent-%COMP%]{background-color:#fff;padding:25px;border-radius:16px;box-shadow:0 4px 20px #0000000f;border:1px solid rgba(0,0,0,.02)}.admin-panel[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%], .filters[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{margin-bottom:20px;color:#1a1a1a;font-size:1.25rem;border-bottom:2px solid #f0f0f0;padding-bottom:15px;font-weight:700}.admin-panel[_ngcontent-%COMP%]{background:linear-gradient(to bottom right,#fff8e1,#fff);border-left:5px solid #ff9800}.btn-admin[_ngcontent-%COMP%]{display:flex;align-items:center;width:100%;padding:14px;margin-bottom:12px;background-color:#fff;color:#333;border:1px solid #e0e0e0;border-radius:10px;text-align:left;cursor:pointer;font-weight:600;transition:all .2s;font-size:1rem}.btn-admin[_ngcontent-%COMP%]:hover{background-color:#ff9800;color:#fff;border-color:#ff9800;transform:translate(5px)}.filters[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{font-weight:600;color:#555;display:block;margin-bottom:8px;font-size:.95rem}.filters[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]{width:100%;padding:12px;border:1px solid #ddd;border-radius:8px;font-size:1rem;background-color:#f9f9f9;cursor:pointer}.cards-container[_ngcontent-%COMP%]{flex:1;display:grid;grid-template-columns:repeat(auto-fill,minmax(350px,1fr));gap:30px;align-content:start}.card[_ngcontent-%COMP%]{background-color:#fff;border-radius:16px;padding:30px;box-shadow:0 4px 20px #0000000a;display:flex;flex-direction:column;transition:transform .3s ease,box-shadow .3s ease;border:1px solid rgba(0,0,0,.03);min-height:280px;justify-content:space-between}.card[_ngcontent-%COMP%]:hover{transform:translateY(-5px);box-shadow:0 12px 30px #0000001a}.card-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:start;margin-bottom:20px}.card[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{margin:0;color:#1a1a1a;font-size:1.5rem;font-weight:700;line-height:1.2}.badge-tipo[_ngcontent-%COMP%]{background-color:#e3f2fd;color:#1565c0;padding:6px 12px;border-radius:20px;font-size:.85rem;font-weight:700;text-transform:uppercase;letter-spacing:.5px}.card-body[_ngcontent-%COMP%]{flex-grow:1}.card-body[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:12px 0;color:#4a4a4a;font-size:1.1rem;display:flex;align-items:center;gap:8px}.estado-badge[_ngcontent-%COMP%]{font-weight:700;padding:4px 0}.btn-reservar[_ngcontent-%COMP%]{margin-top:20px;padding:16px;background-color:#28a745;color:#fff;border:none;border-radius:10px;cursor:pointer;font-weight:700;font-size:1.1rem;width:100%;transition:all .2s;text-transform:uppercase;letter-spacing:.5px;box-shadow:0 4px 10px #28a74533}.btn-reservar[_ngcontent-%COMP%]:hover{background-color:#218838;box-shadow:0 6px 15px #28a7454d;transform:translateY(-2px)}.btn-reservar[_ngcontent-%COMP%]:disabled{background-color:#e0e0e0;color:#999;cursor:not-allowed;box-shadow:none;transform:none}.empty-state[_ngcontent-%COMP%], .loading[_ngcontent-%COMP%]{grid-column:1/-1;text-align:center;padding:60px;color:#666;background-color:#fff;border-radius:16px;font-size:1.2rem;box-shadow:0 4px 20px #0000000d}@media (max-width: 1024px){.main-container[_ngcontent-%COMP%]{flex-direction:column;padding:20px}.sidebar[_ngcontent-%COMP%]{width:100%;display:grid;grid-template-columns:1fr 1fr;gap:20px}.cards-container[_ngcontent-%COMP%]{grid-template-columns:repeat(auto-fill,minmax(300px,1fr))}}@media (max-width: 768px){header[_ngcontent-%COMP%]{flex-direction:column;gap:15px;padding:20px}.top-buttons[_ngcontent-%COMP%]{flex-wrap:wrap;justify-content:center;width:100%}.top-buttons[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{flex:1}.sidebar[_ngcontent-%COMP%]{display:flex;flex-direction:column}.cards-container[_ngcontent-%COMP%]{grid-template-columns:1fr}}']})};export{X as ReservasComponent};
