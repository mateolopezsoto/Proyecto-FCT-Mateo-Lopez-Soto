import{Aa as f,Ba as d,C as e,Ca as g,c as u,d as o,g as i,l as h,o as c,qa as p}from"./chunk-6KVODD7N.js";var s=u(f());var m=class n{http=c(p);authService=c(g);apiUrl=d.apiUrl;tipos=e([]);instalacions=e([]);horarios=e([]);loading=e(!1);constructor(){}cargarDatos(){return o(this,null,function*(){if(!this.loading()){this.loading.set(!0);try{let r=[],a=[],t=[];try{r=yield i(this.http.get(`${this.apiUrl}/tipos-instalacion`))}catch{console.warn("Fallo esperado o 401 en Tipos de Instalaci\xF3n.")}try{a=yield i(this.http.get(`${this.apiUrl}/instalacions`))}catch{console.warn("Fallo esperado o 401 en Instalaciones.")}try{t=yield i(this.http.get(`${this.apiUrl}/horarios`))}catch{console.warn("Fallo esperado o 401 en Horarios.")}if(this.tipos.set(r),this.instalacions.set(a),this.horarios.set(t),r.length===0&&a.length===0&&t.length===0)throw new Error("No se puido cargar ning\xFAn recurso.")}catch{s.default.fire("Erro","Non se puideron cargar as instalaci\xF3ns","error")}finally{this.loading.set(!1)}}})}reservar(r){return o(this,null,function*(){this.loading.set(!0);try{yield i(this.http.post(`${this.apiUrl}/reservas`,r)),s.default.fire("Perfecto!","Reserva confirmada","success"),yield this.cargarDatos()}catch(a){let t=a.error?.message||"Erro ao reservar";throw s.default.fire("Erro",t,"error"),a}finally{this.loading.set(!1)}})}cargarHistorico(){return o(this,null,function*(){this.loading.set(!0);try{return yield i(this.http.get(`${this.apiUrl}/mis-reservas`))}catch(r){throw r}finally{this.loading.set(!1)}})}cancelarReserva(r){return o(this,null,function*(){this.loading.set(!0);try{yield i(this.http.put(`${this.apiUrl}/reservas/${r}/cancelar`,{}))}catch(a){throw a}finally{this.loading.set(!1)}})}static \u0275fac=function(a){return new(a||n)};static \u0275prov=h({token:n,factory:n.\u0275fac,providedIn:"root"})};export{m as a};
