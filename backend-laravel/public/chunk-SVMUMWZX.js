import{a as F}from"./chunk-P2IZZ4D7.js";import{Ca as k,E as g,G as s,H as f,J as e,K as n,L as x,M as b,N as h,O as d,P as C,Q as i,R as p,S as O,Y as P,ka as M,la as w,o as m,p as u,pa as E,t as _,u as v,wa as S,xa as y,z as o,za as I}from"./chunk-6KVODD7N.js";function z(a,r){a&1&&(e(0,"div",4),x(1,"i",5),i(2," Cargando datos... "),n())}function R(a,r){if(a&1&&(e(0,"div",17)(1,"span",18),i(2),n(),e(3,"div",19),x(4,"div",20),e(5,"span",21),i(6),n()()()),a&2){let t=r.$implicit,c=d().ngIf,l=d();o(),C("title",t.nombre),o(),O(" ",t.nombre," "),o(2),f("width",l.getPorcentaxe(t.total,c.graficas.por_instalacion)),o(2),p(t.total)}}function A(a,r){a&1&&(e(0,"div",22),i(1," Sen datos de reservas por instalaci\xF3n. "),n())}function V(a,r){if(a&1&&(e(0,"div",23)(1,"span",24),i(2),n(),e(3,"div",25),x(4,"div",26),e(5,"span",27),i(6),n()()()),a&2){let t=r.$implicit,c=d().ngIf,l=d();o(2),p(t.hora),o(2),f("width",l.getPorcentaxe(t.total,c.graficas.por_hora)),o(2),p(t.total)}}function j(a,r){a&1&&(e(0,"div",22),i(1," Sen datos horarios. "),n())}function D(a,r){if(a&1){let t=b();e(0,"div")(1,"div",6)(2,"div",7)(3,"h2"),i(4),n(),e(5,"p"),i(6,"Total Reservas"),n()(),e(7,"div",7)(8,"h2"),i(9),n(),e(10,"p"),i(11,"Instalaci\xF3ns Activas"),n()(),e(12,"div",7)(13,"h2"),i(14),n(),e(15,"p"),i(16,"Usuarios Rexistrados"),n()()(),e(17,"div",8)(18,"div",9)(19,"h3"),i(20,"Reservas por Instalaci\xF3n"),n(),e(21,"div",10),g(22,R,7,5,"div",11)(23,A,2,0,"div",12),n()(),e(24,"div",9)(25,"h3"),i(26,"Reservas por Franxa Horaria"),n(),e(27,"div",13),g(28,V,7,4,"div",14)(29,j,2,0,"div",12),n()()(),e(30,"div",15)(31,"button",16),h("click",function(){_(t);let l=d();return v(l.adminService.exportarInforme())}),i(32," Exportar Informe CSV "),n()()()}if(a&2){let t=r.ngIf,c=d();o(4),p(t.contadores.reservas),o(5),p(t.contadores.instalacions),o(5),p(t.contadores.usuarios),o(8),s("ngForOf",t.graficas.por_instalacion),o(),s("ngIf",t.graficas.por_instalacion.length===0),o(5),s("ngForOf",t.graficas.por_hora),o(),s("ngIf",t.graficas.por_hora.length===0),o(2),s("disabled",c.adminService.loading())}}var T=class a{adminService=m(F);authService=m(k);router=m(S);ngOnInit(){if(this.authService.usuario()?.rol?.nome_rol!=="Administrador"){this.router.navigate(["/reservas"]);return}this.adminService.cargarEstatisticas()}getPorcentaxe(r,t){if(!t||t.length===0)return"0%";let c=Math.max(...t.map(l=>l.total));return r/c*100+"%"}static \u0275fac=function(t){return new(t||a)};static \u0275cmp=u({type:a,selectors:[["app-estatisticas"]],standalone:!0,features:[P],decls:8,vars:2,consts:[[1,"container"],["routerLink","/reservas",1,"btn-volver"],["class","loading",4,"ngIf"],[4,"ngIf"],[1,"loading"],[1,"fas","fa-spinner","fa-spin"],[1,"stats-counters"],[1,"counter"],[1,"charts"],[1,"chart"],[1,"bar-chart-container"],["class","bar-group",4,"ngFor","ngForOf"],["class","no-data",4,"ngIf"],[1,"pie-chart-container"],["class","time-row",4,"ngFor","ngForOf"],[1,"export-btn"],[3,"click","disabled"],[1,"bar-group"],[1,"label",3,"title"],[1,"bar-wrapper"],[1,"bar"],[1,"value"],[1,"no-data"],[1,"time-row"],[1,"time-label"],[1,"time-bar-wrapper",2,"flex","1","display","flex","align-items","center","background-color","#f0f0f0","border-radius","6px","height","24px"],[1,"time-bar"],[1,"time-value"]],template:function(t,c){t&1&&(e(0,"div",0)(1,"header")(2,"h1"),i(3,"Panel de Estat\xEDsticas"),n(),e(4,"button",1),i(5,"\u2190 Volver ao Cat\xE1logo"),n()(),g(6,z,3,0,"div",2)(7,D,33,8,"div",3),n()),t&2&&(o(6),s("ngIf",c.adminService.loading()),o(),s("ngIf",c.adminService.estatisticas()))},dependencies:[E,M,w,I,y],styles:['@charset "UTF-8";*[_ngcontent-%COMP%]{box-sizing:border-box;margin:0;padding:0;font-family:Arial,sans-serif}[_nghost-%COMP%]{display:block;background-color:#f5f5f5;min-height:100vh;padding:20px}.container[_ngcontent-%COMP%]{max-width:1200px;margin:0 auto}header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;margin-bottom:25px}h1[_ngcontent-%COMP%]{color:#333;margin:0}.btn-volver[_ngcontent-%COMP%]{padding:8px 15px;background-color:#6c757d;color:#fff;border:none;border-radius:8px;cursor:pointer;text-decoration:none}.stats-counters[_ngcontent-%COMP%]{display:flex;justify-content:space-between;gap:20px;margin-bottom:30px;flex-wrap:wrap}.counter[_ngcontent-%COMP%]{flex:1;min-width:200px;background-color:#fff;padding:20px;border-radius:12px;box-shadow:0 0 15px #0000000d;text-align:center}.counter[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{font-size:2.5rem;color:#4285f4;margin:0 0 5px}.counter[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{color:#555;font-weight:700;margin:0}.charts[_ngcontent-%COMP%]{display:flex;gap:20px;flex-wrap:wrap}.chart[_ngcontent-%COMP%]{flex:1;min-width:350px;background-color:#fff;padding:25px;border-radius:12px;box-shadow:0 0 15px #0000000d}.chart[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{margin-top:0;margin-bottom:20px;color:#333;border-bottom:1px solid #eee;padding-bottom:10px}.bar-chart-container[_ngcontent-%COMP%], .pie-chart-container[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:12px}.bar-group[_ngcontent-%COMP%], .time-row[_ngcontent-%COMP%]{display:flex;align-items:center;gap:15px}.label[_ngcontent-%COMP%]{width:150px;min-width:100px;font-size:.95rem;font-weight:600;color:#333;text-align:right;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}.time-label[_ngcontent-%COMP%]{width:60px;font-size:.9rem;color:#555;text-align:right}.bar-wrapper[_ngcontent-%COMP%], .time-bar-wrapper[_ngcontent-%COMP%]{flex:1;background-color:#f0f0f0;border-radius:6px;height:24px;position:relative;display:flex;align-items:center}.bar[_ngcontent-%COMP%]{background-color:#4285f4;height:100%;border-radius:6px;min-width:4px;transition:width 1s ease-out}.time-bar[_ngcontent-%COMP%]{background-color:orange;border-radius:6px;height:100%;min-width:4px}.values-container[_ngcontent-%COMP%]{margin-left:10px;display:flex;gap:5px;align-items:center;white-space:nowrap;position:absolute;left:5px}.value[_ngcontent-%COMP%], .time-value[_ngcontent-%COMP%]{font-weight:700;color:#333;font-size:.9rem}.percentage[_ngcontent-%COMP%]{font-size:.8rem;color:#666;font-weight:400}.no-data[_ngcontent-%COMP%]{text-align:center;color:#999;font-style:italic;padding:20px}.export-btn[_ngcontent-%COMP%]{margin-top:40px;display:flex;justify-content:center;margin-bottom:40px}.export-btn[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{padding:15px 30px;background-color:#28a745;color:#fff;border:none;border-radius:8px;font-size:1.1rem;cursor:pointer;transition:background .3s;display:flex;align-items:center;gap:10px}.export-btn[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:hover{background-color:#218838}.export-btn[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:disabled{background-color:#ccc;cursor:not-allowed}.loading[_ngcontent-%COMP%]{text-align:center;padding:50px;font-size:1.2rem;color:#666}@media (max-width: 768px){.stats-counters[_ngcontent-%COMP%], .charts[_ngcontent-%COMP%]{flex-direction:column}.chart[_ngcontent-%COMP%]{min-width:100%}.bar-group[_ngcontent-%COMP%]{flex-direction:column;align-items:flex-start;gap:5px}.label[_ngcontent-%COMP%]{width:100%;text-align:left}.bar-wrapper[_ngcontent-%COMP%]{width:100%}.values-container[_ngcontent-%COMP%]{position:relative;left:auto;margin-left:auto;padding-right:5px}}']})};export{T as EstatisticasComponent};
